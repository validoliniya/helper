{% extends 'base.html.twig' %}
{% block body %}
    {{ render(path('command.nav.menu')) }}
    <div class="flex-center">
        <div class="part-2 left white"><h1>{{ section.name|capitalize }} Commands</h1></div>
        <div class="part-2 right" style="margin-right: 15px">
            <button><a class="white button" href="{{ path('command.create') }}">Add new command</a></button>
        </div>
    </div>
    {% if pagination.getItems|length > 0 %}
    <table class="table">
        <thead>
        <tr>
            <th>Name</th>
            <th>Command</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for command in pagination %}
            <tr>
                <td>{{ command.name }}</td>
                <td>{{ command.example }}</td>
                <td>
                    <div class="flex-center">
                        <div style="margin-top: 2px;padding-right: 20px">
                        <a href="{{ path('command.update', {'id': command.id}) }}"><svg width="15" height="15">
                                <use xlink:href="#edit-icon"></use>
                            </svg></a>
                        </div>
                        <div data-delete-command-url="{{ path('api.v1.command.delete', {'id': command.id}) }}"><b>
                                <svg width="20" height="20">
                                    <use xlink:href="#trash-icon"></use>
                                </svg>
                            </b>
                        </div>
                    </div>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
        <div class="main-block white ">No commands found</div>
    {% endif %}
    {{ knp_pagination_render(pagination, '@KnpPaginator/Pagination/twitter_bootstrap_v4_pagination.html.twig') }}
{% endblock %}
{% block javascripts %}
<script>
    // document.addEventListener('DOMContentLoaded', function() {
    //     document.querySelectorAll('div[data-delete-command-url]').forEach(function(el) {
    //         el.addEventListener('click', function(evt) {
    //             evt.preventDefault();
    //             location.reload();
    //             fetch(el.getAttribute('data-delete-command-url'),{
    //                 method: `DELETE`,
    //             })
    //                 .then(response => {
    //                     if(response.status === 200){
    //                         alert('Command deleted!');
    //                             } else {
    //                              alert('An error ');
    //                             }
    //                 })
    //         })
    //     });
    // })
</script>
{% endblock %}
